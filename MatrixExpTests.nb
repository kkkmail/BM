(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10645,        273]
NotebookOptionsPosition[      9835,        246]
NotebookOutlinePosition[     10210,        262]
CellTagsIndexPosition[     10167,        259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"toFloat", "[", 
      RowBox[{"s_", "?", "StringQ"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringCount", "[", 
         RowBox[{"s", ",", " ", "\"\<.\>\""}], "]"}], " ", "\[Equal]", " ", 
        "0"}], ",", " ", 
       RowBox[{"s", " ", "<>", " ", "\"\<.0\>\""}], ",", " ", "s"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toFSharMatrix", "[", 
      RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "s", ",", " ", "nn", ",", " ", "mm", ",", " ", "ii", ",", " ", "jj"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", " ", "=", " ", "\"\<\\n[\\n\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nn", " ", "=", " ", 
         RowBox[{"Length", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mm", " ", "=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"m", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"mm", " ", ">", " ", "1"}], ",", " ", 
              RowBox[{"s", " ", "=", " ", 
               RowBox[{"s", " ", "<>", " ", "\"\<    [ \>\""}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", " ", "=", " ", 
                 RowBox[{"s", " ", "<>", " ", 
                  RowBox[{"toFloat", "[", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", 
                    RowBox[{"m", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "]"}], "]"}], 
                   "]"}], " ", "<>", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"jj", " ", "<", " ", "mm"}], ",", " ", 
                    "\"\<; \>\"", ",", " ", "\"\<\>\""}], "]"}]}]}], ";"}], 
               "\[IndentingNewLine]", ")"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"jj", ",", " ", "1", ",", " ", "mm"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"mm", " ", ">", " ", "1"}], " ", ",", 
              RowBox[{"s", " ", "=", " ", 
               RowBox[{"s", " ", "<>", " ", "\"\< ]\\n\>\""}]}]}], "]"}], 
            ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", " ", "1", ",", " ", "nn"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", " ", 
        RowBox[{"s", "=", 
         RowBox[{"StringReplace", "[", " ", 
          RowBox[{
           RowBox[{"s", " ", "<>", " ", "\"\<]\\n\>\""}], ",", " ", 
           RowBox[{"\"\<\\\"\>\"", " ", "\[Rule]", " ", "\"\<\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", " ", "[", "s", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
      "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<m0 = \>\"", ",", " ", 
      RowBox[{"m0", " ", "//", " ", "toFSharMatrix"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b0", " ", "=", " ", 
     RowBox[{"MatrixExp", "[", "m0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<b0 = \>\"", ",", " ", 
      RowBox[{
       RowBox[{"N", "[", "b0", "]"}], " ", "//", " ", "toFSharMatrix"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}]}], 
      "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<m = \>\"", ",", " ", 
      RowBox[{"m", " ", "//", " ", "toFSharMatrix"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"MatrixExp", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<b = \>\"", ",", " ", 
      RowBox[{
       RowBox[{"N", "[", "b", "]"}], " ", "//", " ", "toFSharMatrix"}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7443128996840277`*^9, 3.7443129066847963`*^9}, 
   3.7443129492862096`*^9, {3.744313221669345*^9, 3.7443132351000967`*^9}, {
   3.7443133107109485`*^9, 3.744313362574428*^9}, {3.744320384359934*^9, 
   3.7443205261289473`*^9}, {3.744320602646546*^9, 3.744320726487051*^9}, {
   3.7443207613159456`*^9, 3.7443208749906926`*^9}, {3.7443209205511627`*^9, 
   3.744320953967506*^9}},ExpressionUUID->"bd83c3bb-61fa-4c34-a977-\
4c166119bfe7"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"m0 = \"\>", 
   "\[InvisibleSpace]", "\<\"\\n[\\n    [ 1.0; 0.0; 0.0; 0.0 ]\\n    [ 0.0; \
1.0; 0.0; 0.0 ]\\n    [ 0.0; 0.0; 1.0; 0.0 ]\\n    [ 0.0; 0.0; 0.0; 1.0 ]\\n]\
\\n\"\>"}],
  SequenceForm[
  "m0 = ", "\n[\n    [ 1.0; 0.0; 0.0; 0.0 ]\n    [ 0.0; 1.0; 0.0; 0.0 ]\n    \
[ 0.0; 0.0; 1.0; 0.0 ]\n    [ 0.0; 0.0; 0.0; 1.0 ]\n]\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7443205711585865`*^9, {3.7443206482400064`*^9, 3.7443206898137474`*^9}, 
   3.7443207366688094`*^9, {3.744320779870028*^9, 3.7443208269310193`*^9}, 
   3.744320956695636*^9},ExpressionUUID->"3ce92a33-581a-45fe-b850-\
105659d9eb51"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"b0 = \"\>", 
   "\[InvisibleSpace]", "\<\"\\n[\\n    [ 2.718281828459045; 0.; 0.; 0. ]\\n  \
  [ 0.; 2.718281828459045; 0.; 0. ]\\n    [ 0.; 0.; 2.718281828459045; 0. \
]\\n    [ 0.; 0.; 0.; 2.718281828459045 ]\\n]\\n\"\>"}],
  SequenceForm[
  "b0 = ", "\n[\n    [ 2.718281828459045; 0.; 0.; 0. ]\n    [ 0.; \
2.718281828459045; 0.; 0. ]\n    [ 0.; 0.; 2.718281828459045; 0. ]\n    [ 0.; \
0.; 0.; 2.718281828459045 ]\n]\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7443205711585865`*^9, {3.7443206482400064`*^9, 3.7443206898137474`*^9}, 
   3.7443207366688094`*^9, {3.744320779870028*^9, 3.7443208269310193`*^9}, 
   3.744320956705633*^9},ExpressionUUID->"33f9e0fd-dd66-4082-8dcb-\
41e1f1a9e7c2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"m = \"\>", 
   "\[InvisibleSpace]", "\<\"\\n[\\n    [ 0.0; 0.0; 0.0; 1.0 ]\\n    [ 0.0; \
0.0; 1.0; 0.0 ]\\n    [ 0.0; 1.0; 0.0; 0.0 ]\\n    [ 1.0; 0.0; 0.0; 0.0 ]\\n]\
\\n\"\>"}],
  SequenceForm[
  "m = ", "\n[\n    [ 0.0; 0.0; 0.0; 1.0 ]\n    [ 0.0; 0.0; 1.0; 0.0 ]\n    [ \
0.0; 1.0; 0.0; 0.0 ]\n    [ 1.0; 0.0; 0.0; 0.0 ]\n]\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7443205711585865`*^9, {3.7443206482400064`*^9, 3.7443206898137474`*^9}, 
   3.7443207366688094`*^9, {3.744320779870028*^9, 3.7443208269310193`*^9}, 
   3.744320956708632*^9},ExpressionUUID->"33409d56-8161-4b31-b063-\
04aa44d10eb7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"b = \"\>", 
   "\[InvisibleSpace]", "\<\"\\n[\\n    [ 1.5430806348152437; 0.; 0.; \
1.1752011936438014 ]\\n    [ 0.; 1.5430806348152437; 1.1752011936438014; 0. ]\
\\n    [ 0.; 1.1752011936438014; 1.5430806348152437; 0. ]\\n    [ \
1.1752011936438014; 0.; 0.; 1.5430806348152437 ]\\n]\\n\"\>"}],
  SequenceForm[
  "b = ", "\n[\n    [ 1.5430806348152437; 0.; 0.; 1.1752011936438014 ]\n    [ \
0.; 1.5430806348152437; 1.1752011936438014; 0. ]\n    [ 0.; \
1.1752011936438014; 1.5430806348152437; 0. ]\n    [ 1.1752011936438014; 0.; \
0.; 1.5430806348152437 ]\n]\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7443205711585865`*^9, {3.7443206482400064`*^9, 3.7443206898137474`*^9}, 
   3.7443207366688094`*^9, {3.744320779870028*^9, 3.7443208269310193`*^9}, 
   3.744320956709632*^9},ExpressionUUID->"85f1fcdb-a0c5-4fc7-8495-\
92f596f4dc11"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1078, 813},
WindowMargins->{{210, Automatic}, {65, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6197, 150, 739, "Input", "ExpressionUUID" -> \
"bd83c3bb-61fa-4c34-a977-4c166119bfe7"],
Cell[CellGroupData[{
Cell[6802, 176, 670, 14, 157, "Print", "ExpressionUUID" -> \
"3ce92a33-581a-45fe-b850-105659d9eb51"],
Cell[7475, 192, 760, 15, 157, "Print", "ExpressionUUID" -> \
"33f9e0fd-dd66-4082-8dcb-41e1f1a9e7c2"],
Cell[8238, 209, 668, 14, 157, "Print", "ExpressionUUID" -> \
"33409d56-8161-4b31-b063-04aa44d10eb7"],
Cell[8909, 225, 898, 17, 157, "Print", "ExpressionUUID" -> \
"85f1fcdb-a0c5-4fc7-8495-92f596f4dc11"]
}, Open  ]]
}, Open  ]]
}
]
*)

